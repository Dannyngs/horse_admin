!function(){"use strict";angular.module("horseAdmin",["ngResource","ui.router","ui.bootstrap","toastr"]).factory("AuthService",function(){var e=null,t=null,a={login:function(a,n){e=a,t=n},logout:function(){e=null,t=null},isLogined:function(){return t?!0:!1},getCurrentUser:function(){return e},getCurentToken:function(){return t}};return a}).factory("authInterceptor",["$rootScope","$q","$window","AuthService",function(e,t,a,n){return{request:function(e){return e.headers=e.headers||{},n.getCurentToken()&&(e.headers.token=n.getCurentToken()),e}}}])}(),function(){"use strict";function e(e,t,a,n,o,r,l,s){t.update={},t.update._id=s._id,t.update.note=s.note,t.update.salePrice=s.salePrice,t.update.password=s.password,t.updateMember=function(t){return""==t.password?n.warning("Password cannot be empty","Warning"):void e.put(a.backendURL+"/api/users/"+t._id,t).then(function(e){a.users=e.data,n.success("Success"),l.close(),a.setPage(1)},function(e){n.error(e.data,"Error")})},t.closeModel=function(){l.dismiss("cancel")}}e.$inject=["$http","$scope","$rootScope","toastr","AuthService","$location","$uibModalInstance","selected_user"],angular.module("horseAdmin").controller("UpdateController",e)}(),function(){"use strict";function e(e,t,a,n,o){function r(){e.get(s+"/fetchRace").then(function(e){t.races=e.data},function(e){})}function l(){t.selectText="Loading...",t.resetText="Reset",e({method:"POST",url:s+"/",data:{link:t.selectedlink,lang:"chinese"}}).then(function(e){t.selectedRace=e.data;var a=t.race.hl;return a&&0==a.length?(n.error("Failed to get any data!"),void(t.selectText="Select Race")):void(t.selectText="Select Race")},function(e){n.error("Failed!"+e),t.selectText="Select Race"})}var s="http://racingprohk.ap-southeast-1.elasticbeanstalk.com";t.selectText="Select Race",t.resetText="Reset",t.saveText="Save",r(),t.selectRace=l,t.saveRace=function(){return console.log("saving race"+t.selectedRace.length),t.selectedRace?(t.saveText="Saving",void e({method:"POST",url:s+"/saveRace",data:{race:t.selectedRace}}).then(function(e){t.saveText="Save",console.log(e),t.selectedRace=e.data.race,n.success("Race has been updated ")},function(e){t.saveText="Save",n.error("Failed!"+e)})):(n.error("No race to save!"),void(t.saveText="Saving"))},t.resetRace=function(a){t.resetText="Resetting",e({method:"POST",url:s+"/resetRace/",data:{raceLink:t.selectedRace.raceLink}}).then(function(e){l()},function(e){n.error("Failed!"+e)})}}e.$inject=["$http","$scope","$rootScope","toastr","AuthService"],angular.module("horseAdmin").controller("RaceController",e)}(),function(){"use strict";function e(){function e(e,t,a,n,o){t.navText=e.navText,t.logout=function(){confirm("Sure to Log out?")&&(n.success("Log out Successfully!!"),a.logout(),e.dp_background=!1,o.path("/login"))}}e.$inject=["$rootScope","$scope","AuthService","toastr","$location"];var t={restrict:"E",templateUrl:"app/view/navbar.html",scope:{creationDate:"="},controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("horseAdmin").directive("acmeNavbar",e)}(),function(){"use strict";function e(e,t,a,n){function o(){e.get(t.backendURL+"/api/multiplelogin").then(function(e){for(var t=null,n=[],o=0;o<e.data.length;o++){var r=e.data[o];r.username!=t?(r.count=1,t=r.username,n.push(r)):(n[n.length-1].count++,n[n.length-1].date=r.date)}a.multiplelogin=n},function(e){n.error(e.data)})}o(),a.emptyRecords=function(){e["delete"](t.backendURL+"/api/multiplelogin/").then(function(e){n.success(e.data,"Success"),o(),console.log("empty!")},function(e){})}}e.$inject=["$http","$rootScope","$scope","toastr"],angular.module("horseAdmin").controller("MultipleController",e)}(),function(){"use strict";function e(e,t,a,n,o){t.user={},t.showpassword=!1,t.currentPage=1,t.itemsPerPage=100,a.setPage=function(e){t.currentPage=e},t.pageChanged=function(){a.getMembers((t.currentPage-1)*t.itemsPerPage)},"Dream Project"==a.navText&&(a.dp_background=!0),t.showpass=function(){t.showpassword=!t.showpassword},a.getMembers=function(n){e.get(a.backendURL+"/api/users/"+n+"/"+t.itemsPerPage).then(function(e){a.users=e.data.users,t.totalItems=e.data.total_count})},a.searchMember=function(n){e.get(a.backendURL+"/api/users/"+n).then(function(e){a.users=e.data,t.totalItems=e.data,e.data.length>100&&alert("We can only present 100 rows of result for you !")})},a.getMembers(0),t.deleteMember=function(t){confirm("Sure to delete?")&&e["delete"](a.backendURL+"/api/users/"+t).then(function(e){n.success("Success"),console.log(e.data),a.users=e.data,a.setPage(1)},function(e){})},t.showAddMember=function(e){$("#addModel").modal("show"),t.addMember={},t.addMember.role="member",t.roles=[{label:"Member",value:"member"},{label:"Admin",value:"admin"}],console.log(t.roles)},t.showUpdateMember=function(e){$("#updateModel").modal("show"),t.update={},t.update._id=e._id,t.update.note=e.note,t.update.salePrice=e.salePrice,t.update.password=e.password},t.openUpdate=function(e){o.open({animation:!0,templateUrl:"app/view/updateModel.html",controller:"UpdateController",resolve:{selected_user:function(){return e}}})},t.openCreate=function(){o.open({animation:!0,templateUrl:"app/view/createModel.html",controller:"CreateController",resolve:{items:function(){return t.items}}})}}e.$inject=["$http","$scope","$rootScope","toastr","$uibModal"],angular.module("horseAdmin").controller("MemberController",e)}(),function(){"use strict";function e(e,t,a,n,o,r){a.user={},a.platform="Dream Project",t.navText="Admin Panel",a.adminLogin=function(l){"Racing Pro"==a.platform?(t.navText="Racing Pro ",t.backendURL="http://racingprohk.ap-southeast-1.elasticbeanstalk.com/admin"):(t.backendURL="http://football-back-dev.ap-southeast-1.elasticbeanstalk.com/admin",t.navText="Dream Project"),e.post(t.backendURL+"/api/login",{id:l.id,password:l.password}).then(function(e){n.success("Login Successfully!!"),o.login(l,e.data.token),r.path("/")},function(e){console.log(e),n.error("Auth Failed!")})}}e.$inject=["$http","$rootScope","$scope","toastr","AuthService","$location"],angular.module("horseAdmin").controller("LoginController",e)}(),function(){"use strict";function e(e,t,a,n,o){function r(){e.get(a.backendURL+"/api/onlineusers").then(function(e){t.onlineusers=e.data},function(){})}r(),t.refreshOnlineMembers=r,t.takeoffline=function(t){e["delete"](a.backendURL+"/api/onlineusers/"+t).then(function(e){n.success(e.data),r()},function(e){})}}e.$inject=["$http","$scope","$rootScope","toastr","AuthService"],angular.module("horseAdmin").controller("CurrentController",e)}(),function(){"use strict";function e(e,t,a,n,o,r,l){t.addMember={},t.addMember.role="member",t.roles=[{label:"Member",value:"member"},{label:"Admin",value:"admin"}],t.saveMember=function(t){return""==t.password||""==t.username?a.warning("Username or Password cannot be empty","Warning"):void e.post(l.backendURL+"/api/users",t).then(function(e){a.success("Success"),l.users=e.data,l.setPage(1),t={}},function(e){a.error(e.data,"Error")})},t.closeModel=function(){r.dismiss("cancel")}}e.$inject=["$http","$scope","toastr","AuthService","$location","$uibModalInstance","$rootScope"],angular.module("horseAdmin").controller("CreateController",e)}(),function(){"use strict";function e(e,t,a,n,o,r){function l(){e.get(a.backendURL+"/api/daytotal").then(function(e){t.daytotal=e.data.daytotal},function(e){console.log(e),n.error("Auth Failed!")}),e.get(a.backendURL+"/api/monthtotal").then(function(e){t.monthtotal=e.data.monthtotal},function(e){console.log(e),n.error("Auth Failed!")})}t.open1=function(){t.popup1.opened=!0},t.open2=function(){t.popup2.opened=!0},t.setDate=function(e,a,n){t.dt=new Date(e,a,n)},t.dateOptions={formatYear:"yy",startingDay:1},t.popup1={opened:!1},t.popup2={opened:!1},t.adminLogin=function(t){e.post(a.backendURL+"/api/login",{id:t.id,password:t.password}).then(function(e){n.success("Login Successfully!!"),o.login(t,e.data.token),r.path("/")},function(e){console.log(e),n.error("Auth Failed!")})},t.getRange=function(o,r){return o&&r?void e.get(a.backendURL+"/api/rangetotal/"+o+"/"+r).then(function(e){t.rangetotal=e.data.totalcost,t.totalusers=e.data.users},function(e){console.log(e),n.error("Auth Failed!")}):n.error("Please select a date range first.")},l()}e.$inject=["$http","$scope","$rootScope","toastr","AuthService","$location"],angular.module("horseAdmin").controller("AccountController",e)}(),function(){"use strict";function e(e,t,a,n){e.debug("runBlock end"),t.$on("$stateChangeStart",function(e,t,o,r,l){return t.authRequired&&!a.isLogined()?n.path("/login"):void("app/view/login.html"===t.templateUrl&&a.isLogined()&&n.path("/home"))})}e.$inject=["$log","$rootScope","AuthService","$location"],angular.module("horseAdmin").run(e)}(),function(){"use strict";function e(e,t){e.state("current",{url:"/current",templateUrl:"app/view/current.html",controller:"CurrentController",controllerAs:"current",authRequired:!0}).state("login",{url:"/login",templateUrl:"app/view/login.html",controller:"LoginController",controllerAs:"login",authRequired:!1}).state("member",{url:"/",templateUrl:"app/view/member.html",controller:"MemberController",controllerAs:"member",authRequired:!0}).state("multiple",{url:"/multiple",templateUrl:"app/view/multiple.html",controller:"MultipleController",controllerAs:"multiple",authRequired:!0}).state("account",{url:"/accounting",templateUrl:"app/view/account.html",controller:"AccountController",controllerAs:"account",authRequired:!0}).state("race",{url:"/race",templateUrl:"app/view/race.html",controller:"RaceController",controllerAs:"race",authRequired:!0}),t.otherwise("/")}e.$inject=["$stateProvider","$urlRouterProvider"],angular.module("horseAdmin").config(e)}(),function(){"use strict";function e(e,t,a){e.debugEnabled(!0),t.allowHtml=!0,t.timeOut=2e3,t.positionClass="toast-top-right",a.interceptors.push("authInterceptor")}e.$inject=["$logProvider","toastrConfig","$httpProvider"],angular.module("horseAdmin").config(e)}(),angular.module("horseAdmin").run(["$templateCache",function(e){e.put("app/view/account.html",'<acme-navbar creation-date="main.creationDate"></acme-navbar><div class="container"><h3>Accounting</h3><div class="row pad10"><div class="col-md-3"><label>From</label><p class="input-group"><input type="text" class="form-control" uib-datepicker-popup="" ng-model="fromDate" is-open="popup1.opened" min-date="minDate" max-date="maxDate" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" ng-required="true" close-text="Close" alt-input-formats="altInputFormats"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="open1()"><i class="glyphicon glyphicon-calendar"></i></button></span></p></div><div class="col-md-3"><label>To</label><p class="input-group"><input type="text" class="form-control" uib-datepicker-popup="" ng-model="toDate" is-open="popup2.opened" min-date="minDate" max-date="maxDate" datepicker-options="dateOptions" date-disabled="disabled(date, mode)" ng-required="true" close-text="Close"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="open2()"><i class="glyphicon glyphicon-calendar"></i></button></span></p></div><div class="col-md-3 col-md-offset-3 pad10"><button ng-click="getRange(fromDate,toDate)" type="button" class="btn btn-primary">Confirm</button></div></div><div class="row"><div class="table-responsive"><table class="table table-hover table-bordered"><thead></thead><td><strong>Monthly Income</strong></td><td><strong>Daily Income</strong></td><tr><td>{{ monthtotal | currency }}</td><td>{{ daytotal | currency }}</td></tr></table></div></div><div class="row"><div class="table-responsive"><table class="table table-hover table-bordered"><thead></thead><td><strong>From:</strong> {{fromDate|date : \'yyyy-MM-dd\'}} <strong>To:</strong> {{toDate|date : \'yyyy-MM-dd\'}}</td><tr><td>{{ rangetotal | currency }}</td></tr></table></div></div><div class="row pad10"><div class="table-responsive"><table class="table table-hover table-bordered"><thead></thead><td>Username ($ = admin)</td><td>Sale Price</td><td>Date</td><tr ng-repeat="u in totalusers | filter:search |orderBy:\'-registeredOn\'"><td><span ng-show="u.role==\'admin\'">$</span>{{u.username}}</td><td>{{u.salePrice|currency}}</td><td>{{u.registeredOn|date:\'yyyy-MM-dd\'}}</td></tr></table></div></div></div>'),e.put("app/view/createModel.html",'<div class="modal-header"><h4 class="modal-title" id="myModalLabel">Add Member</h4></div><div class="modal-body"><form><div class="form-group"><label for="exampleInputEmail1">Username</label> <input type="username" ng-model="addMember.username" class="form-control" placeholder="Username"></div><div class="form-group"><label for="exampleInputPassword1">Password</label> <input type="password" ng-model="addMember.password" class="form-control" placeholder="Password"></div><div class="form-group"><label for="exampleInputPassword1">Role</label><select class="form-control" ng-model="addMember.role" ng-options="r.value as r.label for r in roles"></select></div><div class="form-group"><label for="exampleInputEmail1">Sale Price</label> <input type="number" ng-model="addMember.salePrice" class="form-control" placeholder="salePrice"></div><div class="form-group"><label for="exampleInputPassword1">Note</label> <input type="text" ng-model="addMember.note" class="form-control" placeholder="Note"></div></form></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="closeModel()">Close</button> <button ng-click="saveMember(addMember)" type="button" class="btn btn-primary">Save</button></div>'),e.put("app/view/current.html",'<acme-navbar creation-date="main.creationDate"></acme-navbar><div class="container"><h3>Current Online Member</h3>{{isLogined()}}<div class="row"><div class="col-sm-8 col-md-8 col-md-offset-2"><table class="table table-hover"><thead></thead><td>Member</td><td>Login Date</td><td>Take it offline</td><tr ng-repeat="u in onlineusers"><td>{{u.userkey}}</td><td>{{u.date | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td><button ng-click="takeoffline(u._id)" type="button" class="pull-right btn btn-sm btn-info">Offline</button></td></tr></table><button ng-click="refreshOnlineMembers()" type="button" class="pull-right btn btn-sm btn-primary">Refresh</button></div></div></div>'),e.put("app/view/login.html",'<div class="container" style="padding:20px;"><div class="row"><div class="col-md-6 col-md-offset-3"><div class="jumbotron text-center"><h2 style="font-family: fantasy;">DREAM PROJECT & RACING PRO</h2><form class="pad20"><div class="form-group"><div class="btn-group"><label class="btn blackbtn" ng-click="doit()" ng-model="platform" uib-btn-radio="\'Dream Project\'">Dream Project</label> <label class="btn btn-danger" ng-click="doit()" ng-model="platform" uib-btn-radio="\'Racing Pro\'">Racing Pro</label></div></div><h5>Login to: <span>{{platform}}</span></h5><div class="form-group"><input type="text" class="form-control" id="exampleInputEmail1" placeholder="ID" ng-model="user.id"></div><div class="form-group"><input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password" ng-model="user.password"></div><button type="submit" class="btn blackbtn" ng-click="adminLogin(user)">Login</button></form></div></div></div></div>'),e.put("app/view/member.html",'<acme-navbar creation-date="main.creationDate"></acme-navbar><div class="container"><h3>Member Manager</h3><div class="row pad10"><div class="col-md-3 pad10"><div class="input-group"><input type="text" class="form-control" placeholder="Username,Email,Phone,Note" ng-model="search_content"> <span class="input-group-btn"><button class="btn btn-default" type="button" ng-click="searchMember(search_content)">Search</button></span></div></div><div class="col-md-3 col-md-offset-6 pad10"><button ng-click="getMembers(0)" type="button" class="btn btn-info">Show All</button> <button ng-click="showpass()" type="button" class="btn btn-info">Password</button> <button ng-click="openCreate()" type="button" class="btn btn-primary">Add Member</button></div></div><div class="row pad10"><uib-pagination rotate="true" boundary-links="true" force-ellipses="true" max-size="20" items-per-page="itemsPerPage" total-items="totalItems" ng-model="currentPage" ng-change="pageChanged()"></uib-pagination><div class="table-responsive"><table class="table table-hover table-bordered"><thead></thead><td>Username ($ = admin)</td><td>Password</td><td>Role</td><td>Sale Price</td><td>Note</td><td>Date</td><td>Delete/Update</td><tr ng-repeat="u in users | filter:search |orderBy:\'-username\'"><td><span ng-show="u.role==\'admin\'">$</span>{{u.username}}</td><td><span ng-show="showpassword">{{u.password}}</span><span ng-hide="showpassword">***</span></td><td>{{u.role}}</td><td>{{u.salePrice|currency}}</td><td>{{u.note}}</td><td>{{u.registeredOn|date:\'yyyy-MM-dd\'}}</td><td><div class="btn-group" role="group" aria-label="..."><button class="btn btn-danger" type="button" ng-click="deleteMember(u._id)">Delete</button> <button class="btn btn-primary" type="button" ng-click="openUpdate(u)">Update</button></div></td></tr></table></div></div></div>'),e.put("app/view/multiple.html",'<acme-navbar creation-date="main.creationDate"></acme-navbar><div class="container"><h3>Multiple Online Member</h3><div class="row" style="padding:20px;"><div class="form-inline"><div style="margin:20px;" class="pull-right form-group"><div class="input-group"><input type="text" class="form-control" id="exampleInputAmount" placeholder="Account" ng-model="searchacc.username"> <span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span></div></div></div><table class="table table-hover"><thead></thead><td>Count(s)</td><td>Account</td><td>Date</td><tr ng-repeat="rc in multiplelogin |filter:searchacc"><td>{{rc.count}}</td><td>{{rc.username}}</td><td>{{rc.date | date:\'yyyy-MM-dd HH:mm:ss\'}}</td></tr></table><button ng-click="emptyRecords()" type="button" class="pull-right btn btn-sm btn-danger">Empty Records</button></div></div>'),e.put("app/view/navbar.html",'<nav class="navbar navbar-static-top navbar-inverse"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" ng-init="navCollapsed = true" ng-click="navCollapsed = !navCollapsed"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" href="#">{{navText}}</a></div><div class="collapse navbar-collapse" ng-class="!navCollapsed && \'in\'"><ul class="nav navbar-nav"><li><a ng-href="#">Member</a></li><li><a ng-href="#current">Online User</a></li><li><a ng-href="#multiple">Multiple Login</a></li><li><a ng-href="#accounting">Accounting</a></li><li ng-hide="navText==\'Dream Project\'"><a ng-href="#race">Race</a></li><li><a href="#" ng-click="logout()">Log out</a></li></ul></div></div></nav>'),e.put("app/view/race.html",'<acme-navbar creation-date="main.creationDate"></acme-navbar><div class="container"><h3>Race Manager</h3>{{isLogined()}}<div class="row"><div class="col-sm-8 col-md-8 col-md-offset-2"><form class="form-inline text-right" style="padding:20px;"><div class="input-group"><select class="form-control" placeholder="Username,Email,Phone,Note" ng-model="selectedlink"><option ng-repeat="race in races" value="{{race.link}}">{{race.no}}</option></select><span class="input-group-btn"><button ng-click="selectRace()" class="btn btn-primary" type="submit">{{selectText}}</button></span></div></form><table class="table table-hover table-bordered"><thead></thead><td colspan="3">{{selectedRace.ri}} <span style="color:red" ng-show="selectedRace._id"><br><span>Noticeï¼š Records in this race have been manually sorted. To reset the order please press \'Reset\' button.</span></span></td><thead></thead><td>Horse No.</td><td>Horse Name</td><td>Horse Score</td><tr ng-repeat="horse in selectedRace.hl"><td>{{horse.no}}</td><td>{{horse.horse}}</td><td><input type="number" ng-model="horse.grade"></td></tr></table><button ng-show="selectedRace" class="btn btn-primary" ng-click="saveRace()">{{saveText}}</button> <button ng-show="selectedRace._id" class="btn btn-danger" ng-click="resetRace()">{{resetText}}</button></div></div></div>'),e.put("app/view/updateModel.html",'<div class="modal-header"><h4 class="modal-title" id="myModalLabel">Update</h4></div><div class="modal-body"><form><div class="form-group"><label for="exampleInputPassword1">Password</label> <input type="password" ng-model="update.password" class="form-control" placeholder="Password"></div><div class="form-group"><label for="exampleInputEmail1">Sale Price</label> <input type="number" ng-model="update.salePrice" class="form-control" placeholder="salePrice"></div><div class="form-group"><label for="exampleInputPassword1">Note</label> <input type="text" ng-model="update.note" class="form-control" placeholder="Note"></div></form></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="closeModel()">Close</button> <button ng-click="updateMember(update)" type="button" class="btn btn-primary">Update</button></div>')}]);
//# sourceMappingURL=../maps/scripts/app-5a1d4ebb95.js.map
